import ExportCsvButton from "@/components/ExportCsvButton";
import ImportCsvButton from "@/components/ImportCsvButton";

export const dynamic = "force-dynamic";
type Client = { id:number; code:string; name:string; email?:string; phone?:string; city?:string; country?:string; is_active:boolean; };
export default async function ClientsPage(){
  const res = await fetch("http://127.0.0.1:8000/api/v1/exploitation/clients/", { headers: { "Accept":"application/json" }, cache: "no-store" });
  const data = await res.json();
  const clients: Client[] = Array.isArray(data) ? data : (data.results ?? []);
  return (
    <div className="card">
      <h1 className="text-xl font-semibold mb-4">Exploitation · Clients</h1>
      <div className="overflow-x-auto">
        <table className="min-w-[600px] text-sm">
          <thead><tr className="text-left"><th className="p-2">Code</th><th className="p-2">Nom</th><th className="p-2">Email</th><th className="p-2">Téléphone</th><th className="p-2">Ville</th><th className="p-2">Pays</th><th className="p-2">Actif</th></tr></thead>
          <tbody>
            {clients.map(c=>(
              <tr key={c.id} className="border-t">
                <td className="p-2">{c.code}</td>
                <td className="p-2">{c.name}</td>
                <td className="p-2">{c.email ?? "-"}</td>
                <td className="p-2">{c.phone ?? "-"}</td>
                <td className="p-2">{c.city ?? "-"}</td>
                <td className="p-2">{c.country ?? "-"}</td>
                <td className="p-2">{c.is_active ? "Oui" : "Non"}</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>
  );
}
