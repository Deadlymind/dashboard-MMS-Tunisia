import ClientTabs from "@/components/ClientTabs";

async function getClient(id: string){
  const r = await fetch(`http://127.0.0.1:8000/api/v1/exploitation/clients/${id}/`, { cache:"no-store", headers:{Accept:"application/json"}});
  if(!r.ok) return null;
  return r.json();
}

type Params = Promise<{ id: string }>;

export default async function ClientLayout({ params, children }:{ params: Params; children: React.ReactNode }){
  const p = await params;                          // ‚Üê await params
  const client = await getClient(p.id);
  const name = client?.raison_sociale ?? `Client #${params.id}`;
  const base = `/exploitation/structure/clients/${p.id}`;
  return (
    <section className="space-y-4">
      <h1 className="text-2xl font-semibold">CLIENTS &gt; {name}</h1>
      <ClientTabs base={base}/>
      {children}
    </section>
  );
}
